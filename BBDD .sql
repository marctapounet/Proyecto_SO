

DROP DATABASE IF EXISTS bd;
CREATE DATABASE bd;

USE bd;

CREATE TABLE USUARIO (
	ID		INT NOT NULL PRIMARY KEY,
	USERNAME	VARCHAR(60) NOT NULL,
	PASSWORD	VARCHAR(60) NOT NULL,
	EDAD		INT
) ENGINE = InnoDB;

CREATE TABLE PARTIDA (
	ID		INT NOT NULL PRIMARY KEY,
	FECHA_P		VARCHAR(60),
	HORATERMINA	VARCHAR(60),
	DURACION	INT,
	GANADOR		INT
) ENGINE = InnoDB;

CREATE TABLE PARTICIPACION (
	ID_P		INT NOT NULL,
	ID_U		INT NOT NULL,
	POSICION	INT,
	PUNTOS		INT,
	
	FOREIGN KEY (ID_P) REFERENCES PARTIDA(ID),
	FOREIGN KEY (ID_U) REFERENCES USUARIO(ID)
	
) ENGINE = InnoDB;



INSERT INTO USUARIO VALUES (1234, 'josegomez', 'joselitoxd', 23);
INSERT INTO USUARIO VALUES (2298, 'elmatador', 'pizzapinya', 19);
INSERT INTO USUARIO VALUES (7301, 'xxlagrangexx', 'tomatina', 32);

INSERT INTO PARTIDA VALUES (24, '1 de Enero de 2020', '13:07', 12, 1234);
INSERT INTO PARTIDA VALUES (11, '23 de Julio de 2019', '21:01', 9, 2298);
INSERT INTO PARTIDA VALUES (4, '5 de Noviembre de 2019', '22:35', 16, 2298);
INSERT INTO PARTIDA VALUES (32, '17 de Marzo de 2020', '4:20', 21, 7301);

/* Suponemos un juego donde el ganador obtiene 25 puntos, y el perdedor 0*/

INSERT INTO PARTICIPACION VALUES (24, 1234, 1, 25);
INSERT INTO PARTICIPACION VALUES (24, 2298, 2, 0);
INSERT INTO PARTICIPACION VALUES (11, 2298, 1, 25);
INSERT INTO PARTICIPACION VALUES (11, 7301, 2, 0);
INSERT INTO PARTICIPACION VALUES (4, 2298, 1, 25);
INSERT INTO PARTICIPACION VALUES (4, 1234, 2, 0);
INSERT INTO PARTICIPACION VALUES (32, 7301, 1, 25);
INSERT INTO PARTICIPACION VALUES (32, 1234, 2, 0);


/* DAME USERNAME DEL JUGADOR CUYA EDAD OSCILA ENTRE LOS 20 Y 30 AÑOS QUE HA GANADO 25 PUNTOS EN UNA PARTIDA QUE HAYA DURADO MÁS DE 15 MINUTOS. */


SELECT 		USUARIO.USERNAME FROM (USUARIO, PARTIDA, PARTICIPACION)
WHERE 		USUARIO.ID = PARTICIPACION.ID_U
AND 		PARTICIPACION.PUNTOS = 25 
AND 		PARTICIPACION.ID_U = USUARIO.ID
AND 		USUARIO.EDAD > 20
AND 		USUARIO.EDAD < 35
AND 		USUARIO.ID = PARTICIPACION.ID_U
AND 		PARTICIPACION.ID_P = PARTIDA.ID
AND 		PARTIDA.DURACION > 15;



















